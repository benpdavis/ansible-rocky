---
- name: instal epel-release repositories
  dnf:
    name: epel-release
  become: true
  
- name: install Mosquitto
  dnf:
    name: mosquitto
  become: true
  
- name: enable and start Mosquitto service
  service:
    name: mosquitto
    enabled: true
    state: started
  become: true

- name: copying pwfile into Mosquitto directory
  copy:
    src: files/etc/mosquitto/pwfile
    dest: /etc/mosquitto/pwfile
  become: true

- name: set Mosquitto pwfile in mosquitto.conf
  lineinfile:
    path: /etc/mosquitto/mosquitto.conf
    line: password_file /etc/mosquitto/pwfile
  become: true
  notify: restart mosquitto